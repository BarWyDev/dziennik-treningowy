import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as m}from"./index.TcFrwHGi.js";import{o as C,n as c,s as l,b as W,l as D,u as P,a as F,L as i,C as j}from"./Label.CntfKGud.js";import{B as z}from"./Button.DG6KPLDP.js";import{I as w}from"./Input.hTVRzoe8.js";import{S as L}from"./Select.DKs09Ukh.js";import{A as B}from"./Alert.D-DBx2Lh.js";const M=C({trainingTypeId:l().uuid("Wybierz typ treningu"),date:l().regex(/^\d{4}-\d{2}-\d{2}$/,"Nieprawidłowy format daty"),time:l().regex(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/,"Nieprawidłowy format czasu (HH:MM)").or(D("")).optional(),durationMinutes:c().min(1,"Czas trwania musi wynosić co najmniej 1 minutę").max(600,"Czas trwania nie może przekraczać 10 godzin"),ratingOverall:c().min(1,"Ocena musi być w skali 1-5").max(5,"Ocena musi być w skali 1-5"),ratingPhysical:c().min(1,"Ocena musi być w skali 1-5").max(5,"Ocena musi być w skali 1-5").optional(),ratingEnergy:c().min(1,"Ocena musi być w skali 1-5").max(5,"Ocena musi być w skali 1-5").optional(),ratingMotivation:c().min(1,"Ocena musi być w skali 1-5").max(5,"Ocena musi być w skali 1-5").optional(),ratingDifficulty:c().min(1,"Ocena musi być w skali 1-5").max(5,"Ocena musi być w skali 1-5").optional(),trainingGoal:l().max(500,"Cel treningu może mieć maksymalnie 500 znaków").optional(),mostSatisfiedWith:l().max(500,"Pole może mieć maksymalnie 500 znaków").optional(),improveNextTime:l().max(500,"Pole może mieć maksymalnie 500 znaków").optional(),howToImprove:l().max(500,"Pole może mieć maksymalnie 500 znaków").optional(),notes:l().max(1e3,"Notatki mogą mieć maksymalnie 1000 znaków").optional(),caloriesBurned:c().min(0,"Kalorie nie mogą być ujemne").max(1e4,"Wartość kalorii jest za wysoka").optional().or(W()).transform(r=>isNaN(r)?void 0:r)});M.partial();C({startDate:l().optional(),endDate:l().optional(),trainingTypeId:l().uuid().optional(),page:c().min(1).default(1),limit:c().min(1).max(100).default(20)});function f({value:r,onChange:d,error:g}){const[x,p]=m.useState(null),u=x??r??0,h=n=>{d(r===n?void 0:n)};return e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(n=>e.jsx("button",{type:"button",className:"p-1 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 rounded",onMouseEnter:()=>p(n),onMouseLeave:()=>p(null),onClick:()=>h(n),children:e.jsx("svg",{className:`w-8 h-8 lg:w-9 lg:h-9 transition-colors ${n<=u?"text-yellow-400 fill-yellow-400 dark:text-yellow-500 dark:fill-yellow-500":"text-gray-300 dark:text-gray-700"}`,viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"})})},n))}),r&&e.jsxs("p",{className:"mt-1 text-sm lg:text-base text-gray-500 dark:text-gray-400",children:["Ocena: ",r,"/5 (kliknij ponownie, aby usunąć)"]}),g&&e.jsx("p",{className:"mt-1 text-sm lg:text-base text-error-600 dark:text-error-400",children:g})]})}function G({value:r,onChange:d,error:g}){const[x,p]=m.useState(Math.floor(r/60)),[u,h]=m.useState(r%60);m.useEffect(()=>{p(Math.floor(r/60)),h(r%60)},[r]);const n=s=>{const o=Math.max(0,Math.min(10,s));p(o),d(o*60+u)},k=s=>{const o=Math.max(0,Math.min(59,s));h(o),d(x*60+o)},v=[15,30,45,60,90,120];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"0",max:"10",value:x,onChange:s=>n(parseInt(s.target.value)||0),className:"w-16 px-3 py-2 text-sm lg:text-base text-center border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 rounded-lg focus:border-primary-500 focus:ring-1 focus:ring-primary-500 focus:outline-none"}),e.jsx("span",{className:"text-sm lg:text-base text-gray-600 dark:text-gray-400",children:"godz."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"0",max:"59",value:u,onChange:s=>k(parseInt(s.target.value)||0),className:"w-16 px-3 py-2 text-sm lg:text-base text-center border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 rounded-lg focus:border-primary-500 focus:ring-1 focus:ring-primary-500 focus:outline-none"}),e.jsx("span",{className:"text-sm lg:text-base text-gray-600 dark:text-gray-400",children:"min."})]})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:v.map(s=>e.jsx("button",{type:"button",onClick:()=>d(s),className:`px-3 py-1 text-xs lg:text-sm font-medium rounded-full transition-colors ${r===s?"bg-primary-600 dark:bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:s>=60?`${s/60}h`:`${s}min`},s))}),g&&e.jsx("p",{className:"mt-1 text-sm lg:text-base text-error-600 dark:text-error-400",children:g})]})}function U({training:r,onSuccess:d}){const[g,x]=m.useState(null),[p,u]=m.useState(!1),[h,n]=m.useState([]),[k,v]=m.useState(!0),s=!!r,{register:o,handleSubmit:S,control:b,formState:{errors:t},reset:H}=P({resolver:F(M),defaultValues:{trainingTypeId:r?.trainingTypeId||"",date:r?.date||new Date().toISOString().split("T")[0],time:r?.time||"",durationMinutes:r?.durationMinutes||30,ratingOverall:r?.ratingOverall||3,ratingPhysical:r?.ratingPhysical||void 0,ratingEnergy:r?.ratingEnergy||void 0,ratingMotivation:r?.ratingMotivation||void 0,ratingDifficulty:r?.ratingDifficulty||void 0,trainingGoal:r?.trainingGoal||"",mostSatisfiedWith:r?.mostSatisfiedWith||"",improveNextTime:r?.improveNextTime||"",howToImprove:r?.howToImprove||"",notes:r?.notes||"",caloriesBurned:r?.caloriesBurned||void 0}});m.useEffect(()=>{(async()=>{try{const y=await fetch("/api/training-types");if(y.ok){const N=await y.json();n(N)}}catch{console.error("Error fetching training types")}finally{v(!1)}})()},[]);const I=async a=>{u(!0),x(null);try{const y=s?`/api/trainings/${r.id}`:"/api/trainings",T=await fetch(y,{method:s?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!T.ok){const E=await T.json();throw new Error(E.error||"Wystąpił błąd")}d?d():window.location.href="/trainings"}catch(y){x(y instanceof Error?y.message:"Wystąpił błąd")}finally{u(!1)}},O=h.map(a=>({value:a.id,label:a.name}));return e.jsxs("form",{onSubmit:S(I),className:"space-y-6",children:[g&&e.jsx(B,{variant:"error",children:g}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"trainingTypeId",required:!0,children:"Typ treningu"}),k?e.jsx("div",{className:"h-10 bg-gray-100 dark:bg-gray-800 rounded-lg animate-pulse"}):e.jsx(L,{id:"trainingTypeId",options:O,placeholder:"Wybierz typ treningu",error:t.trainingTypeId?.message,...o("trainingTypeId")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"date",required:!0,children:"Data"}),e.jsx(w,{id:"date",type:"date",error:t.date?.message,...o("date")})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"time",children:"Godzina (opcjonalnie)"}),e.jsx(w,{id:"time",type:"time",placeholder:"HH:MM",error:t.time?.message,...o("time")})]})]}),e.jsxs("div",{children:[e.jsx(i,{required:!0,children:"Czas trwania"}),e.jsx(j,{name:"durationMinutes",control:b,render:({field:a})=>e.jsx(G,{value:a.value,onChange:a.onChange,error:t.durationMinutes?.message})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"trainingGoal",children:"Mój cel na trening (mentalny i fizyczny)"}),e.jsx("textarea",{id:"trainingGoal",rows:2,className:"block w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 px-3 py-2 text-sm lg:text-base placeholder-gray-400 dark:placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500",placeholder:"Co chcesz osiągnąć podczas tego treningu?",...o("trainingGoal")}),t.trainingGoal&&e.jsx("p",{className:"mt-1 text-sm lg:text-base text-error-600 dark:text-error-400",children:t.trainingGoal.message})]}),e.jsxs("div",{className:"space-y-4 border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("h3",{className:"font-medium text-base lg:text-lg text-gray-900 dark:text-gray-100",children:"Oceny (skala 1-5)"}),e.jsxs("div",{children:[e.jsx(i,{required:!0,children:"Ogólne zadowolenie"}),e.jsx(j,{name:"ratingOverall",control:b,render:({field:a})=>e.jsx(f,{value:a.value,onChange:a.onChange,error:t.ratingOverall?.message})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Samopoczucie fizyczne (opcjonalnie)"}),e.jsx(j,{name:"ratingPhysical",control:b,render:({field:a})=>e.jsx(f,{value:a.value,onChange:a.onChange,error:t.ratingPhysical?.message})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Poziom energii (opcjonalnie)"}),e.jsx(j,{name:"ratingEnergy",control:b,render:({field:a})=>e.jsx(f,{value:a.value,onChange:a.onChange,error:t.ratingEnergy?.message})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Motywacja (opcjonalnie)"}),e.jsx(j,{name:"ratingMotivation",control:b,render:({field:a})=>e.jsx(f,{value:a.value,onChange:a.onChange,error:t.ratingMotivation?.message})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Trudność treningu (opcjonalnie)"}),e.jsx(j,{name:"ratingDifficulty",control:b,render:({field:a})=>e.jsx(f,{value:a.value,onChange:a.onChange,error:t.ratingDifficulty?.message})})]})]}),e.jsxs("div",{className:"space-y-4 border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("h3",{className:"font-medium text-base lg:text-lg text-gray-900 dark:text-gray-100",children:"Refleksja po treningu"}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"mostSatisfiedWith",children:"Z czego jestem najbardziej zadowolony?"}),e.jsx("textarea",{id:"mostSatisfiedWith",rows:2,className:"block w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 px-3 py-2 text-sm lg:text-base placeholder-gray-400 dark:placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500",placeholder:"Co poszło najlepiej?",...o("mostSatisfiedWith")}),t.mostSatisfiedWith&&e.jsx("p",{className:"mt-1 text-sm lg:text-base text-error-600 dark:text-error-400",children:t.mostSatisfiedWith.message})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"improveNextTime",children:"Co następnym razem chcę zrobić lepiej?"}),e.jsx("textarea",{id:"improveNextTime",rows:2,className:"block w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 px-3 py-2 text-sm lg:text-base placeholder-gray-400 dark:placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500",placeholder:"Nad czym chcesz popracować?",...o("improveNextTime")}),t.improveNextTime&&e.jsx("p",{className:"mt-1 text-sm lg:text-base text-error-600 dark:text-error-400",children:t.improveNextTime.message})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"howToImprove",children:"Jak mogę to zrobić?"}),e.jsx("textarea",{id:"howToImprove",rows:2,className:"block w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 px-3 py-2 text-sm lg:text-base placeholder-gray-400 dark:placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500",placeholder:"Konkretne kroki do poprawy...",...o("howToImprove")}),t.howToImprove&&e.jsx("p",{className:"mt-1 text-sm lg:text-base text-error-600 dark:text-error-400",children:t.howToImprove.message})]})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:e.jsxs("div",{children:[e.jsx(i,{htmlFor:"caloriesBurned",children:"Spalone kalorie (opcjonalnie)"}),e.jsx(w,{id:"caloriesBurned",type:"number",min:"0",max:"10000",placeholder:"np. 300",error:t.caloriesBurned?.message,...o("caloriesBurned",{valueAsNumber:!0})})]})}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"notes",children:"Dodatkowe uwagi i komentarze (opcjonalnie)"}),e.jsx("textarea",{id:"notes",rows:3,className:"block w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 px-3 py-2 text-sm lg:text-base placeholder-gray-400 dark:placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500",placeholder:"Inne obserwacje lub notatki...",...o("notes")}),t.notes&&e.jsx("p",{className:"mt-1 text-sm lg:text-base text-error-600 dark:text-error-400",children:t.notes.message})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(z,{type:"submit",isLoading:p,className:"flex-1",children:s?"Zapisz zmiany":"Dodaj trening"}),e.jsx(z,{type:"button",variant:"secondary",onClick:()=>window.history.back(),children:"Anuluj"})]})]})}export{U as TrainingForm};
