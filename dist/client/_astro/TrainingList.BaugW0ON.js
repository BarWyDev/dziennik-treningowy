import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.TcFrwHGi.js";import{I as v}from"./Input.hTVRzoe8.js";import{S as N}from"./Select.DKs09Ukh.js";import{B as u}from"./Button.DG6KPLDP.js";function T(t){const a=Math.floor(t/60),r=t%60;return a>0?r>0?`${a}h ${r}min`:`${a}h`:`${r}min`}function D(t){return new Date(t).toLocaleDateString("pl-PL",{weekday:"short",day:"numeric",month:"short"})}function L({training:t}){return e.jsxs("a",{href:`/trainings/${t.id}`,className:"block bg-white dark:bg-[#161b22] rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-4 hover:shadow-md hover:border-primary-200 dark:hover:border-primary-700 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg lg:text-xl font-semibold text-gray-900 dark:text-gray-100",children:t.trainingType?.name||"Trening"}),t.rating&&e.jsx("div",{className:"flex items-center gap-0.5",children:[...Array(t.rating)].map((a,r)=>e.jsx("svg",{className:"w-4 h-4 lg:w-5 lg:h-5 text-yellow-400 fill-yellow-400 dark:text-yellow-500 dark:fill-yellow-500",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},r))})]}),e.jsx("p",{className:"text-sm lg:text-base text-gray-500 dark:text-gray-400 mt-1",children:D(t.date)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg lg:text-xl font-semibold text-primary-600 dark:text-primary-400",children:T(t.durationMinutes)}),t.caloriesBurned&&e.jsxs("p",{className:"text-sm lg:text-base text-gray-500 dark:text-gray-400",children:[t.caloriesBurned," kcal"]})]})]}),t.notes&&e.jsx("p",{className:"mt-3 text-sm lg:text-base text-gray-600 dark:text-gray-300 line-clamp-2",children:t.notes})]})}function b({filters:t,onFiltersChange:a}){const[r,c]=l.useState([]),[i,h]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const o=await fetch("/api/training-types");if(o.ok){const p=await o.json();c(p)}}catch{console.error("Error fetching training types")}})()},[]);const y=[{value:"",label:"Wszystkie typy"},...r.map(s=>({value:s.id,label:s.name}))],x=()=>{a({})},g=t.startDate||t.endDate||t.trainingTypeId;return e.jsxs("div",{className:"bg-white dark:bg-[#161b22] rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-4",children:[e.jsxs("button",{type:"button",className:"flex items-center justify-between w-full",onClick:()=>h(!i),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 lg:w-6 lg:h-6 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300 text-base lg:text-lg",children:"Filtry"}),g&&e.jsx("span",{className:"px-2 py-0.5 text-xs lg:text-sm font-medium bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 rounded-full",children:"Aktywne"})]}),e.jsx("svg",{className:`w-5 h-5 lg:w-6 lg:h-6 text-gray-400 dark:text-gray-500 transition-transform ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm lg:text-base font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Od daty"}),e.jsx(v,{type:"date",value:t.startDate||"",onChange:s=>a({...t,startDate:s.target.value||void 0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm lg:text-base font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Do daty"}),e.jsx(v,{type:"date",value:t.endDate||"",onChange:s=>a({...t,endDate:s.target.value||void 0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm lg:text-base font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Typ treningu"}),e.jsx(N,{options:y,value:t.trainingTypeId||"",onChange:s=>a({...t,trainingTypeId:s.target.value||void 0})})]})]}),g&&e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{variant:"ghost",size:"sm",onClick:x,children:"Wyczyść filtry"})})]})]})}function S(){return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-16 w-16 lg:h-20 lg:w-20 text-gray-400 dark:text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("h3",{className:"mt-4 text-lg lg:text-xl font-medium text-gray-900 dark:text-gray-100",children:"Brak treningów"}),e.jsx("p",{className:"mt-2 text-sm lg:text-base text-gray-500 dark:text-gray-400",children:"Nie masz jeszcze żadnych zapisanych treningów. Zacznij śledzić swoje postępy!"}),e.jsx("div",{className:"mt-6",children:e.jsx("a",{href:"/trainings/new",children:e.jsxs(u,{children:[e.jsx("svg",{className:"w-4 h-4 lg:w-5 lg:h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Dodaj pierwszy trening"]})})})]})}function E(){const[t,a]=l.useState([]),[r,c]=l.useState(!0),[i,h]=l.useState({}),[y,x]=l.useState(1),[g,s]=l.useState(!0),o=async(n,d,w=!1)=>{c(!0);try{const m=new URLSearchParams({page:n.toString(),limit:"20"});d.startDate&&m.set("startDate",d.startDate),d.endDate&&m.set("endDate",d.endDate),d.trainingTypeId&&m.set("trainingTypeId",d.trainingTypeId);const k=await fetch(`/api/trainings?${m}`);if(k.ok){const j=await k.json();a(w?[...t,...j.data]:j.data),s(j.data.length===20)}}catch{console.error("Error fetching trainings")}finally{c(!1)}};l.useEffect(()=>{x(1),o(1,i)},[i]);const p=()=>{const n=y+1;x(n),o(n,i,!0)},f=n=>{h(n)};return r&&t.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{filters:i,onFiltersChange:f}),e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,d)=>e.jsxs("div",{className:"bg-white dark:bg-[#161b22] rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-4 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4"})]},d))})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{filters:i,onFiltersChange:f}),t.length===0?e.jsx(S,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3",children:t.map(n=>e.jsx(L,{training:n},n.id))}),g&&e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(u,{variant:"secondary",onClick:p,isLoading:r,children:"Załaduj więcej"})})]})]})}export{E as TrainingList};
